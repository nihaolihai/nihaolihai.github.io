(window.webpackJsonp=window.webpackJsonp||[]).push([[501],{994:function(e,_,t){"use strict";t.r(_);var n=t(6),a=Object(n.a)({},(function(){var e=this,_=e.$createElement,t=e._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql"}},[e._v("#")]),e._v(" mysql")]),e._v(" "),t("h2",{attrs:{id:"组件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#组件"}},[e._v("#")]),e._v(" 组件")]),e._v(" "),t("h3",{attrs:{id:"连接器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#连接器"}},[e._v("#")]),e._v(" 连接器")]),e._v(" "),t("div",{staticClass:"language-shell script extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 注意这边直接在命令行输入密码的方式不推荐")]),e._v("\nmysql -hlocalhost -p3306 -uroot -ph123\n")])])]),t("p",[e._v("连接驱动版本号加")]),e._v(" "),t("p",[e._v("&serverTimezone=UTC")]),e._v(" "),t("ol",[t("li",[e._v("命令中的mysql是客户端连接工具")]),e._v(" "),t("li",[e._v("敲入命令回车")])]),e._v(" "),t("ul",[t("li",[e._v("和server建立tcp连接\n"),t("ul",[t("li",[e._v("长连接\n"),t("code",[e._v("mysql_reset_connection()")])]),e._v(" "),t("li",[e._v("短连接")])])]),e._v(" "),t("li",[e._v("连接器验证用户名和密码")]),e._v(" "),t("li",[e._v("验证不通过，Access denied for user。验证通过，查询用户权限")])]),e._v(" "),t("div",{staticClass:"language-shell script extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("show processlist"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# wait_timeout为客户端空闲超时时间，到达此时间将和服务端断开 28800 s = 8h")]),e._v("\nshow variables like "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'%timeout%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),t("h3",{attrs:{id:"查询缓存-mysql-8去除"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询缓存-mysql-8去除"}},[e._v("#")]),e._v(" 查询缓存(mysql 8去除)")]),e._v(" "),t("div",{staticClass:"language-shell script extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# query_cache_type 默认为OFF,可设置为DEMAND,对指定查询语句实施查询缓存")]),e._v("\nshow variables like "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'%cache%'")]),e._v("\n")])])]),t("h3",{attrs:{id:"词法、语法分析-做什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#词法、语法分析-做什么"}},[e._v("#")]),e._v(" 词法、语法分析(做什么)")]),e._v(" "),t("p",[e._v("语法分析判断用户输入的内容是否符合SQL语法")]),e._v(" "),t("h3",{attrs:{id:"优化器-怎么做"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#优化器-怎么做"}},[e._v("#")]),e._v(" 优化器(怎么做)")]),e._v(" "),t("p",[e._v("多索引决定使用哪个索引\n多表连接，决定使用怎样的执行顺序")]),e._v(" "),t("h3",{attrs:{id:"执行器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行器"}},[e._v("#")]),e._v(" 执行器")]),e._v(" "),t("p",[e._v("执行器调用表对应的存储引擎提供的接口取表中符合条件的行，放到结果集中。")]),e._v(" "),t("p",[e._v("对于写操作需要额外的2个模块redo log和binlog")]),e._v(" "),t("h3",{attrs:{id:"binlog"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#binlog"}},[e._v("#")]),e._v(" binlog")]),e._v(" "),t("p",[e._v("Server层的日志模块，适用于所有存储引擎。binlog用于记录逻辑操作，如以sql或者row更改前后的记录来追加到日志中。\n主要用于数据库的备份。")]),e._v(" "),t("ul",[t("li",[e._v("备份策略\n备份频率")])]),e._v(" "),t("h3",{attrs:{id:"redo-log"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redo-log"}},[e._v("#")]),e._v(" redo log")]),e._v(" "),t("p",[e._v("InnoDB引擎中的日志模块，最初作为插件形式引入MySQL。redo log提升写操作的性能还解决数据库崩溃\nbinlog不能解决的数据不一致问题。为什么redo log可以提升写的性能，之前没有InnoDB时，每次写操作\n都要将内存中的数据直接写会磁盘，而频繁操作IO势必影响性能。使用InnoDB后，可以先记录下对数据操作\n的日志，而不急于写回到磁盘，当数据库空闲或redo日志区满了时再写。这样可以提升数据库写性能。\nredo log实现上以一个文件组，如4个1G大小的文件构成的4G日志区。redo log保持2个指针，write_pos和\ncheck_point。write_pos表示当前写入点，check_point表示可用区终点。当write_pos追上check_point时\n引擎将对check_point后的内容进行擦除，如果4G区域都已用完，那么从头开始擦除。")]),e._v(" "),t("h3",{attrs:{id:"两阶段提交"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#两阶段提交"}},[e._v("#")]),e._v(" 两阶段提交")]),e._v(" "),t("p",[e._v("当使用InnoDB时，redo log和bin log是如何协作以保证数据一致性的呢？")]),e._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("create")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("table")]),e._v(" student"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("int")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("primary")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("key")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" age "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("int")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("insert")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("into")]),e._v(" student "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("select")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("-- 经过词法、语法分析，优化器使用索引，执行器找到id = 1的记录，更新")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("update")]),e._v(" student "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("set")]),e._v(" age "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" age "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("+")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("where")]),e._v(" id "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),t("p",[e._v("我们考量执行"),t("code",[e._v("update student set age = age + 1 where id = 1;")]),e._v("时发生了什么。\n优化器确定使用id索引，执行器调用InnoDB引擎，首先引擎判断id=1的数据是否在内存中，若不在，则从磁盘中查询出id=1的数据，载入到内存中。\n接下来将age字段更改为age+1，写redo log，redo log置为prepare状态，通知Server写binlog，binlog写完通知引擎，引擎将\nredo log置为commit状态。")]),e._v(" "),t("ul",[t("li",[e._v("redo log prepare")]),e._v(" "),t("li",[e._v("write to binlog")]),e._v(" "),t("li",[e._v("redo log commit")])]),e._v(" "),t("p",[e._v("复制表结构")]),e._v(" "),t("p",[e._v("CREATE  TABLE IF NOT EXISTS tb_base_select SELECT * FROM tb_base;")]),e._v(" "),t("p",[e._v("select "),t("code",[e._v("name")]),e._v(" from mysql.proc where db = 'your_db_name' and "),t("code",[e._v("type")]),e._v(" = 'PROCEDURE'")]),e._v(" "),t("p",[e._v("今天")]),e._v(" "),t("if",{attrs:{test:"request.statisticsType!=null and request.statisticsType=='day'.toString()"}},[e._v("\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT(NOW(),'%Y-%m-%d 00:00:00')\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT(NOW(),'%Y-%m-%d 23:59:59')\n")]),e._v(" "),t("p",[e._v("昨天")]),e._v(" "),t("if",{attrs:{test:"request.statisticsType!=null and request.statisticsType=='beforeDay'.toString()"}},[e._v("\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT( DATE_SUB(CURDATE(), INTERVAL 1 DAY), '%Y-%m-%d 00:00:00')\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT( DATE_SUB(CURDATE(), INTERVAL 1 DAY), '%Y-%m-%d 23:59:59')\n")]),e._v(" "),t("p",[e._v("本周")]),e._v(" "),t("if",{attrs:{test:"request.statisticsType!=null and request.statisticsType=='week'.toString()"}},[e._v("\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT( DATE_SUB(CURDATE(), INTERVAL WEEKDAY(CURDATE()) DAY), '%Y-%m-%d 00:00:00')\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT( DATE_ADD(SUBDATE(CURDATE(), WEEKDAY(CURDATE())), INTERVAL 6 DAY), '%Y-%m-%d 23:59:59')\n")]),e._v(" "),t("p",[e._v("上周")]),e._v(" "),t("if",{attrs:{test:"request.statisticsType!=null and request.statisticsType=='beforeWeek'.toString()"}},[e._v("\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT( DATE_SUB( DATE_SUB(CURDATE(), INTERVAL WEEKDAY(CURDATE()) DAY), INTERVAL 1 WEEK), '%Y-%m-%d 00:00:00')\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT( SUBDATE(CURDATE(), WEEKDAY(CURDATE()) + 1), '%Y-%m-%d 23:59:59')\n")]),e._v(" "),t("p",[e._v("本月")]),e._v(" "),t("if",{attrs:{test:"request.statisticsType!=null and request.statisticsType=='month'.toString()"}},[e._v("\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT( CURDATE(), '%Y-%m-01 00:00:00')\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT( LAST_DAY(CURDATE()), '%Y-%m-%d 23:59:59')\n")]),e._v(" "),t("p",[e._v("上月")]),e._v(" "),t("if",{attrs:{test:"request.statisticsType!=null and request.statisticsType=='beforeMonth'.toString()"}},[e._v("\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT( DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y-%m-01 00:00:00')\nAND `CREATION_TIME` "),e._v(" DATE_FORMAT( LAST_DAY(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)), '%Y-%m-%d 23:59:59')\n")]),e._v(" "),t("p",[e._v("本年")]),e._v(" "),t("if",{attrs:{test:"request.statisticsType!=null and request.statisticsType=='year'.toString()"}},[e._v("\nAND YEAR(`CREATION_TIME`) = YEAR(NOW())\n")]),e._v(" "),t("p",[e._v("mysql")]),e._v(" "),t("p",[e._v("查看数据库")]),e._v(" "),t("p",[e._v("select schema_name from information_schema.schemata")]),e._v(" "),t("p",[e._v("查看库下的表")]),e._v(" "),t("p",[e._v("select * from information_schema.tables where table_schema='demo' and TABLE_NAME='user';")]),e._v(" "),t("p",[e._v("查看库下的表结构")]),e._v(" "),t("p",[e._v("select * from information_schema.columns where table_schema='demo' and TABLE_NAME='user';")]),e._v(" "),t("p",[e._v("查看库下的视图")]),e._v(" "),t("p",[e._v("添加字段")]),e._v(" "),t("p",[e._v("ALTER TABLE vrv_paw_rule MODIFY  COLUMN thresholdMin;")]),e._v(" "),t("p",[e._v("重命名表")]),e._v(" "),t("p",[e._v("rename table table1_altered to table;")]),e._v(" "),t("p",[e._v("ALTER TABLE old_table RENAME [TO|AS] new_table;")]),e._v(" "),t("p",[e._v("模糊查询")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("<if test=\"emsListNo != null and emsListNo != ''\">\n        and b.EMS_LIST_NO like '%'|| #{emsListNo} || '%'\n</if>\n")])])]),t("p",[e._v("非空判断")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("<if test=\"flag != null and flag != '' and flag != '-1' and _databaseId == 'oracle'\">\n        and nvl(c.FLAG, '0') = #{flag}\n</if>\n")])])]),t("p",[e._v("日期查询范围")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("<if test=\"request.statisticsType!=null and request.statisticsType=='week'.toString()\">\n    AND `CREATION_TIME` <![CDATA[ >= ]]> DATE_FORMAT(date, '%Y-%m-%d 00:00:00')\n    AND `CREATION_TIME` <![CDATA[ <= ]]> DATE_FORMAT(date, '%Y-%m-%d 23:59:59')\n</if>\n")])])]),t("p",[e._v("now();")]),e._v(" "),t("p",[e._v("复制表结构")]),e._v(" "),t("p",[e._v("CREATE TABLE new_table SELECT * FROM old_table WHERE FALSE;")]),e._v(" "),t("p",[e._v("复制数据")]),e._v(" "),t("p",[e._v("INSERT INTO new_table SELECT * FROM old_table;")]),e._v(" "),t("p",[e._v("修改字段")]),e._v(" "),t("p",[e._v("ALTER TABLE vrv_paw_rule ADD COLUMN thresholdMin;")]),e._v(" "),t("p",[e._v("select * from information_schema.VIEWS where table_schema='demo';")]),e._v(" "),t("p",[e._v("查找索引是否存在")]),e._v(" "),t("p",[e._v("select * from information_schema.statistics\nwhere table_schema='demo' and TABLE_NAME='user' and index_name = 'user_id_IDX'")]),e._v(" "),t("p",[e._v("创建索引")]),e._v(" "),t("p",[e._v("CREATE INDEX index_name ON table_name (column_list);")]),e._v(" "),t("p",[e._v("ALTER TABLE table_name ADD INDEX index_name (column_list)")]),e._v(" "),t("p",[e._v("ALTER TABLE table_name ADD UNIQUE (column_list)")]),e._v(" "),t("p",[e._v("ALTER TABLE table_name ADD PRIMARY KEY (column_list)")]),e._v(" "),t("p",[e._v("删除索引")]),e._v(" "),t("p",[e._v("DROP INDEX index_name ON talbe_name")]),e._v(" "),t("p",[e._v("ALTER TABLE table_name DROP INDEX index_name")]),e._v(" "),t("p",[e._v("ALTER TABLE table_name DROP PRIMARY KEY")]),e._v(" "),t("p",[e._v("--防止数据库中有这个存储过程，先删掉")]),e._v(" "),t("p",[e._v("DROP PROCEDURE IF EXISTS p7;")]),e._v(" "),t("p",[e._v("CREATE PROCEDURE p7()"),t("br"),e._v("\nBEGIN")]),e._v(" "),t("p",[e._v("DECLARE nRetRowCount int;")]),e._v(" "),t("p",[e._v("SELECT count(COLUMN_NAME) INTO nRetRowCount"),t("br"),e._v("\nFROM information_schema.columns"),t("br"),e._v("\nWHERE table_name = 'persons'"),t("br"),e._v("\nAND column_name = 'Id_B';")]),e._v(" "),t("p",[e._v("IF nRetRowCount = 0 THEN    --如果没有记录")]),e._v(" "),t("p",[e._v("ALTER TABLE persons ADD Id_B int(4);")]),e._v(" "),t("p",[e._v("END IF;")]),e._v(" "),t("p",[e._v("END")]),e._v(" "),t("p",[e._v("表是否存在")]),e._v(" "),t("p",[e._v("select *from information_schema.tables where table_name = 'TableName'")]),e._v(" "),t("p",[e._v("表结构")]),e._v(" "),t("p",[e._v("SELECT count(COLUMN_NAME) INTO nRetRowCount FROM information_schema.columns"),t("br"),e._v("\nWHERE UPPER(TABLE_SCHEMA) = UPPER(paramDBName)"),t("br"),e._v("\nAND UPPER(TABLE_NAME) = UPPER(paramTableName)"),t("br"),e._v("\nAND UPPER(COLUMN_NAME) = UPPER(paramColumnName);")]),e._v(" "),t("p",[e._v("去除多余0\nrtrim(rtrim(to_char(l.FACTOR_1,'fm99999999999990.9000000000000'),'0'),'.')  FACTOR_1,\nmybatis传入单个字符判断,针对字符类型值最后加.toString()")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("<if test=\"COP_G_NO != null and COP_G_NO != '' and COP_G_NO=='0'.toString()\">\nand COP_G_NO=#{COP_G_NO}\n</if>\n")])])]),t("p",[e._v("视图")]),e._v(" "),t("p",[e._v("select count(1) from test_view;")]),e._v(" "),t("p",[e._v("oracle存在索引")]),e._v(" "),t("p",[e._v("--preconditions onFail:MARK_RAN\n--precondition-sql-check expectedResult:1 select count(1) from user_indexes where index_name=('IDX_CUS_CONSUME_CUR');\nDROP index IDX_CUS_CONSUME_CUR;")]),e._v(" "),t("p",[e._v("pgsql存在索引")]),e._v(" "),t("p",[e._v("--changeset tfqiu:2\n--preconditions onFail:MARK_RAN\n--precondition-sql-check expectedResult:1 select count(1) from pg_class where relkind='i' and relname=('IDX_CUS_CONSUME_CUR');\nDROP index IDX_CUS_CONSUME_CUR;")]),e._v(" "),t("p",[e._v("postgresql判断一个表是否存在：")]),e._v(" "),t("p",[e._v("select count(*) from pg_class where relname = 'tablename';")]),e._v(" "),t("p",[e._v("oracle判断一个表是否存在：")]),e._v(" "),t("p",[e._v("select count(*) from user_tables where table_name =upper('表名');")]),e._v(" "),t("p",[e._v("存在表")]),e._v(" "),t("p",[e._v("select count (*) from information_schema.tables WHERE table_schema = 'table_schema' and table_name = 'table_name';")]),e._v(" "),t("p",[e._v("select * from information_schema.tables WHERE table_schema = 'table_schema' and table_name = 'table_name';")]),e._v(" "),t("p",[e._v("存在字段")]),e._v(" "),t("p",[e._v("select count(*) from information_schema.columns WHERE table_schema = 'table_schema' and table_name = 'table_name' and column_name = 'column_name';")]),e._v(" "),t("p",[e._v("select * from information_schema.columns WHERE table_schema = 'table_schema' and table_name = 'table_name' and column_name = 'column_name';")]),e._v(" "),t("p",[e._v("//orcle判断索引是否存在则删除")]),e._v(" "),t("p",[e._v("SELECT * FROM information_schema.statistics WHERE table_schema=CurrentDatabase AND table_name = 'rtc_phototype' AND index_name = 'index_name'")]),e._v(" "),t("p",[e._v("declare\nnum1 int;\nbegin\nselect count(*) INTO num1 from all_indexes where index_name='IDX_TESTSSSSSSS';\nif num1=1 then\nExecute immediate'drop index IDX_TESTSSSSSSS';\nExecute immediate'create index IDX_TESTSSSSSSS on T_DC_BILL_CFG(NOTE) indextype is ctxsys.context';\ndbms_output.PUT_LINE('索引已bai经删除');\nelse\ndbms_output.PUT_LINE('索引不存zhi在');\nend if;\nend;")]),e._v(" "),t("p",[e._v("//pgsql判断索引是否存在则删除")]),e._v(" "),t("p",[e._v("DROP index IF EXISTS IDX_CUS_CONSUME_CUR;")]),e._v(" "),t("p",[e._v("嵌套sql")]),e._v(" "),t("p",[e._v("select t1.*,t2.password as uname from user t1\nleft join(\nselect * from test where password ='66' order by id desc\n) t2 on t1.temp=t2.id")]),e._v(" "),t("p",[e._v("oracle\n//用户所有表")]),e._v(" "),t("p",[e._v("SELECT table_name FROM USER_TABLES")]),e._v(" "),t("p",[e._v("//根据库获取表信息")]),e._v(" "),t("p",[e._v("SELECT table_name,column_name,data_default FROM USER_TAB_COLUMNS where table_name in(SELECT table_name FROM USER_TABLES) ORDER BY table_name;")]),e._v(" "),t("p",[e._v("//根据表获取索引字段")]),e._v(" "),t("p",[e._v("select index_name,column_name from user_ind_columns where table_name in(SELECT table_name FROM USER_TABLES) ORDER BY index_name;")]),e._v(" "),t("p",[e._v("//库名下的所有表")]),e._v(" "),t("p",[e._v("SELECT * FROM USER_TABLES;")]),e._v(" "),t("p",[e._v("//根据表获取建表语句")]),e._v(" "),t("p",[e._v("SELECT UPPER('dc_stk'),table_name,data_type,data_length,data_default FROM USER_TAB_COLUMNS WHERE TABLE_NAME = 'T_DC_HX_CODE_ITEM'")]),e._v(" "),t("p",[e._v("//根据表获取索引")]),e._v(" "),t("p",[e._v("select index_name,column_name from user_ind_columns where table_name = upper('T_HX_STK_IMG')")]),e._v(" "),t("p",[e._v("select table_name,index_name,wm_concat(column_name) from user_ind_columns where table_name = upper('T_HX_STK_IMG')\nGROUP BY table_name,index_name")]),e._v(" "),t("p",[e._v("pgsql")]),e._v(" "),t("p",[e._v("//根据库获取表信息")]),e._v(" "),t("p",[e._v("SELECT\nTABLE_NAME\n,\nCOLUMN_NAME,\ncolumn_default\nFROM\ninformation_schema.COLUMNS\nWHERE TABLE_NAME  !~'[-+]?[0-9]*.?[0-9]+([-+]?[0-9]+)?' AND table_schema='dc_bill'\nGROUP BY\nTABLE_NAME,\nCOLUMN_NAME,\ncolumn_default\nORDER BY\nTABLE_NAME,\nCOLUMN_NAME;")]),e._v(" "),t("p",[e._v("//根据表获取索引")]),e._v(" "),t("p",[e._v("SELECT\ntablename,\nindexname,\nSPLIT_PART( SPLIT_PART(indexdef, '(', 2), ')', 1) AS indexCols\nFROM\npg_indexes\nWHERE\ntablename IN (select tablename from pg_tables where schemaname='dc_stk')\nORDER BY\ntablename,\nindexname;")]),e._v(" "),t("p",[e._v("//库名下的所有表")]),e._v(" "),t("p",[e._v("select tablename from pg_tables where schemaname='dc_bill'")]),e._v(" "),t("p",[e._v("SELECT\nTABLE_NAME\n,\nCOLUMN_NAME,\ncolumn_default\nFROM\ninformation_schema.COLUMNS\nWHERE TABLE_NAME  !~'[-+]?[0-9]*.?[0-9]+([-+]?[0-9]+)?' AND table_schema='dc_bill'\nGROUP BY\nTABLE_NAME,\nCOLUMN_NAME,\ncolumn_default\nORDER BY\nTABLE_NAME,\nCOLUMN_NAME;")]),e._v(" "),t("p",[e._v("//库名下的所有表")]),e._v(" "),t("p",[e._v("select a.attnum,a.attname,concat_ws('',t.typname,SUBSTRING(format_type(a.atttypid,a.atttypmod) from '(.*)')) as type,d.description from pg_class c, pg_attribute a , pg_type t, pg_description d\nwhere  c.relname = '' and a.attnum>0 and a.attrelid = c.oid and a.atttypid = t.oid and  d.objoid=a.attrelid and d.objsubid=a.attnum或者")]),e._v(" "),t("p",[e._v("SELECT column_name, column_default\nFROM information_schema.columns\nWHERE (table_schema, table_name) = ('dc_hx', 't_hx_price_bill_source')")]),e._v(" "),t("p",[e._v("create function getusername(userid int) returns varchar(32)\nreads sql data  -- 从数据库中读取数据，但不修改数据\nbegin\ndeclare username varchar(32) default '';\nselect name into username from users where id=userid;\nreturn username;\nend;")]),e._v(" "),t("p",[e._v("模糊查询")]),e._v(" "),t("p",[e._v("oralce")]),e._v(" "),t("p",[e._v("instr(G_MODEL, #{G_MODEL,jdbcType=VARCHAR}) > 0")]),e._v(" "),t("p",[e._v("pgsql")]),e._v(" "),t("p",[e._v("like concat(concat('%', #{COP_G_NO,jdbcType=VARCHAR}), '%')")]),e._v(" "),t("p",[e._v("select count(1) from user_indexes where index_name = upper('IDX_DC_BILL_PUSH_HEAD_SID');")]),e._v(" "),t("p",[e._v("create index IDX_DC_BILL_PUSH_HEAD_SID on wewe(SID);")]),e._v(" "),t("p",[e._v('DROP index IF EXISTS "idx_dc_bill_push_head_sid";')]),e._v(" "),t("p",[e._v('create index IDX_DC_BILL_PUSH_HEAD_SID on "we" (SID);')]),e._v(" "),t("p",[e._v("拼接sql")]),e._v(" "),t("p",[e._v("mysql")]),e._v(" "),t("p",[e._v("select aa."),t("code",[e._v("name")]),e._v("name , GROUP_CONCAT( money ) money from aa GROUP BY aa."),t("code",[e._v("name")])]),e._v(" "),t("p",[e._v("oracle")]),e._v(" "),t("p",[e._v("SELECT wm_concat(BUSINESS_TYPE)  FROM T_EMS_DEC_LOG GROUP BY TRADE_CODE ;")]),e._v(" "),t("p",[e._v("pgsql")]),e._v(" "),t("p",[e._v("SELECT array_to_string(ARRAY(SELECT unnest(array_agg(business_type ))),',')  FROM T_EMS_DEC_LOG GROUP BY TRADE_CODE;")]),e._v(" "),t("p",[e._v("sqlserver")]),e._v(" "),t("p",[e._v("SELECT region, STRING_AGG(route_name, ',') AS route_name\nFROM route_details\nLEFT JOIN ride_details ON route_id = r_id\nWHERE region != '' AND service_date = '2019-09-02'\nGROUP BY region")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("<if test=\"inputDateFrom != null and inputDateFrom != ''\">\n        <![CDATA[ and INPUT_DATE >= to_date(#{inputDateFrom}, 'yyyy-mm-dd')]]>\n    </if>\n    <if test=\"inputDateTo != null and inputDateTo != ''\">\n        <![CDATA[ and INPUT_DATE < to_date(#{inputDateTo}, 'yyyy-mm-dd') + 1 ]]>\n</if>\n")])])]),t("p",[e._v("非空判断")]),e._v(" "),t("p",[e._v("oracel")]),e._v(" "),t("p",[e._v("NVL(TYPE, 'OTH')")]),e._v(" "),t("p",[e._v("pgsql")]),e._v(" "),t("p",[e._v("COALESCE(TYPE, 'oth')")]),e._v(" "),t("p",[e._v("mysql")]),e._v(" "),t("p",[e._v("isnull(value1,‘0’)")]),e._v(" "),t("p",[e._v("sqlserver")]),e._v(" "),t("p",[e._v("IFNULL(value,'0')")]),e._v(" "),t("p",[e._v("ALTER TABLE test MODIFY DCR_CYCLE DEFAULT null;")]),e._v(" "),t("p",[e._v("ALTER TABLE test ALTER COLUMN dcr_cycle DROP DEFAULT;")]),e._v(" "),t("p",[e._v("//分析表")]),e._v(" "),t("p",[e._v("oracle")]),e._v(" "),t("p",[e._v("analyze table test compute statistics;")]),e._v(" "),t("p",[e._v("pgsql")]),e._v(" "),t("p",[e._v("analyze test;")]),e._v(" "),t("p",[e._v("mysql")]),e._v(" "),t("p",[e._v("ANALYZE TABLE Statement;")]),e._v(" "),t("p",[e._v("-- 添加临时列")]),e._v(" "),t("p",[e._v("alter table we add tmp_col NUMBER(8);")]),e._v(" "),t("p",[e._v("alter table we modify (EXG_VERSION VARCHAR2(50));")]),e._v(" "),t("p",[e._v("alter table we drop column tmp_col;")]),e._v(" "),t("p",[e._v("ALTER TABLE ew alter column EXG_VERSION type VARCHAR(50);")]),e._v(" "),t("p",[e._v("alter table  we add column pre_seq_no varchar(18);")]),e._v(" "),t("p",[e._v("循环sql游标")]),e._v(" "),t("p",[e._v("CURSOR CUR_BILL_LIST IS")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("SELECT * from test\n\nFOR UPDATE;\n\nBEGIN\n\nFOR CUR_REC IN CUR_BILL_LIST LOOP\n\nUPDATE tere SET SERIAL_NO = P_SERIAL_NO\n\nWHERE CURRENT OF CUR_BILL_LIST;\n\n--自增+1\n\nP_SERIAL_NO := P_SERIAL_NO + 1;\n\nEND LOOP;\n\nEND;\n")])])]),t("p",[e._v("DECLARE")]),e._v(" "),t("p",[e._v("cur_bill_list CURSOR FOR\nSELECT * from test\nFOR UPDATE;\nBEGIN\np_serial_no :=0;\nFOR cur_rec IN cur_bill_list LOOP\nUPDATE test\nSET serial_no = p_serial_no\nWHERE CURRENT OF cur_bill_list;\n/* 自增+1 */\np_serial_no := p_serial_no + 1;\nEND LOOP;\nEND;")]),e._v(" "),t("p",[e._v("特殊字符")]),e._v(" "),t("p",[e._v("INSERT INTO we (SID,TYPE,NAME,INSERT_TIME) VALUES\n(sys_guid(),'MODEL_ERR_CHAR','清单规格型号错误字符',sysdate);")]),e._v(" "),t("p",[e._v("insert into wew (TYPE, CODE, NAME, NOTE, SID, HEAD_ID)\nvalues ('MODEL_ERR_CHAR', '\\t', '特殊字符', '清单规格型号错误字符', sys_guid(), (select SID from we where TYPE = 'MODEL_ERR_CHAR' AND ROWNUM = 1));")]),e._v(" "),t("p",[e._v("insert into wew (TYPE, CODE, NAME, NOTE, SID, HEAD_ID)\nvalues ('MODEL_ERR_CHAR', '\\n', '特殊字符', '清单规格型号错误字符', sys_guid(), (select SID from we where TYPE = 'MODEL_ERR_CHAR' AND ROWNUM = 1));")]),e._v(" "),t("p",[e._v("insert into wew (TYPE, CODE, NAME, NOTE, SID, HEAD_ID)\nvalues ('MODEL_ERR_CHAR', '\\r', '特殊字符', '清单规格型号错误字符', sys_guid(), (select SID from we where TYPE = 'MODEL_ERR_CHAR' AND ROWNUM = 1));")]),e._v(" "),t("p",[e._v("INSERT INTO we (type,code,name,note,sid,head_id) VALUES\n('MODEL_ERR_CHAR', chr(9) chr(10) chr(13), '特殊字符', '清单规格型号错误字符',sys_guid(), (select sid from we where type = 'MODEL_ERR_CHAR' LIMIT 1));")]),e._v(" "),t("p",[e._v("select * from we where instr(NAME,'\\t',1,1) > 0;")]),e._v(" "),t("p",[e._v("select * from we where instr(NAME,'\\n',1,1) > 0;")]),e._v(" "),t("p",[e._v("select * from we where instr(NAME,'\\r',1,1) > 0;")]),e._v(" "),t("p",[e._v("--校验是否包含特殊字符")]),e._v(" "),t("p",[e._v("UPDATE wew TMP\nSET TMP.TEMP_FLAG   = '1',\nTMP.TEMP_REMARK = TMP.TEMP_REMARK || '|规格型号中含有非法字符，如：\\n '\nWHERE TMP.TEMP_OWNER = P_TEMP_OWNER\nAND (instr(G_MODEL,'\\n',1,1) > 0 OR instr(G_MODEL,chr(10),1,1) > 0)\nAND EXISTS\n(SELECT 1\nFROM we\nWHERE TYPE ='MODEL_ERR_CHAR' AND CODE ='\\n' AND ROWNUM = 1);")]),e._v(" "),t("p",[e._v("UPDATE we TMP\nSET TMP.TEMP_FLAG   = '1',\nTMP.TEMP_REMARK = TMP.TEMP_REMARK || '|规格型号中含有非法字符，如：\\t '\nWHERE TMP.TEMP_OWNER = P_TEMP_OWNER\nAND (instr(G_MODEL,'\\t',1,1) > 0 OR instr(G_MODEL,chr(9),1,1) > 0)\nAND EXISTS\n(SELECT 1\nFROM ew\nWHERE TYPE ='MODEL_ERR_CHAR' AND CODE ='\\t' AND ROWNUM = 1);")]),e._v(" "),t("p",[e._v("UPDATE we TMP\nSET TMP.TEMP_FLAG   = '1',\nTMP.TEMP_REMARK = TMP.TEMP_REMARK || '|规格型号中含有非法字符，如：\\r '\nWHERE TMP.TEMP_OWNER = P_TEMP_OWNER\nAND (instr(G_MODEL,'\\r',1,1) > 0 OR instr(G_MODEL,chr(13),1,1) > 0)\nAND EXISTS\n(SELECT 1\nFROM we\nWHERE TYPE ='MODEL_ERR_CHAR' AND CODE ='\\r' AND ROWNUM = 1);\nCOMMIT;")]),e._v(" "),t("p",[e._v("INSERT INTO we (sid,type,name,insert_time) VALUES\n(sys_guid(),'MODEL_ERR_CHAR','清单规格型号错误字符',now());")]),e._v(" "),t("p",[e._v("INSERT INTO we (type,code,name,note,sid,head_id) VALUES\n('MODEL_ERR_CHAR', '\\t', '特殊字符', '清单规格型号错误字符',sys_guid(), (select sid from t_dc_bill_code_catalog where type = 'MODEL_ERR_CHAR' LIMIT 1));")]),e._v(" "),t("p",[e._v("INSERT INTO we (type,code,name,note,sid,head_id) VALUES\n('MODEL_ERR_CHAR', '\\n', '特殊字符', '清单规格型号错误字符',sys_guid(), (select sid from t_dc_bill_code_catalog where type = 'MODEL_ERR_CHAR' LIMIT 1));")]),e._v(" "),t("p",[e._v("INSERT INTO we (type,code,name,note,sid,head_id) VALUES\n('MODEL_ERR_CHAR', '\\r', '特殊字符', '清单规格型号错误字符',sys_guid(), (select sid from t_dc_bill_code_catalog where type = 'MODEL_ERR_CHAR' LIMIT 1));")]),e._v(" "),t("p",[e._v("INSERT INTO we (type,code,name,note,sid,head_id) VALUES\n('MODEL_ERR_CHAR', chr(9) chr(10) chr(13), '特殊字符', '清单规格型号错误字符',sys_guid(), (select sid from t_dc_bill_code_catalog where type = 'MODEL_ERR_CHAR' LIMIT 1));")]),e._v(" "),t("p",[e._v("select * from   we where position('\\t' in name) > 0;")]),e._v(" "),t("p",[e._v("select * from   wew where position('\\n' in name) > 0;")]),e._v(" "),t("p",[e._v("select * from   wewe where position('\\r' in name) > 0;")]),e._v(" "),t("p",[e._v("如果oracle用begin end;要加;  pgsql 不需要begin end;")]),e._v(" "),t("p",[e._v("验证长度")]),e._v(" "),t("p",[e._v("LENGTHB(NOTE)>100")]),e._v(" "),t("p",[e._v("TMP.TEMP_REMARK || '|当前状态不允许录入数据!'")]),e._v(" "),t("p",[e._v("REGEXP_LIKE(CODE_T_S, '^[0-9]*$')")]),e._v(" "),t("p",[e._v("(CODE_T_S IS NULL OR CODE_T_S = '')")]),e._v(" "),t("p",[e._v("OCTET_LENGTH(g_name) > 255")]),e._v(" "),t("p",[e._v("regexp_like((code_t_s)::TEXT, ('^[0-9]*$')::TEXT)")]),e._v(" "),t("p",[e._v("CONCAT_WS('', tmp.temp_remark, '|名称不能为空')")]),e._v(" "),t("p",[e._v("删除默认值")]),e._v(" "),t("p",[e._v("ALTER TABLE werw ALTER COLUMN dcr_cycle DROP DEFAULT;")]),e._v(" "),t("p",[e._v("ALTER TABLE wew ALTER COLUMN dcr_cycle DROP DEFAULT;")]),e._v(" "),t("p",[e._v("update werw t\nset ucns_dcl_stat = l.ucns_dcl_stat,\nmodify_mark = case t.modify_mark when '3' then '3' else '1' end")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("    where t.trade_code = #{tradeCode}\n        and t.cop_ems_no = #{copEmsNo}\n    and exists(\n            select 1 from werw p\n        \twhere t.cop_exg_no = p.cop_exg_no)\n")])])]),t("p",[e._v("update werw t\nset ucns_dcl_stat = l.ucns_dcl_stat,\nmodify_mark = case t.modify_mark when '3' then '3' else '1' end\nfrom werwe l\nwhere t.trade_code = #{tradeCode}\nand t.cop_ems_no = #{copEmsNo}\nand t.cop_exg_no = l.cop_exg_no;")]),e._v(" "),t("p",[e._v("执行存储过程")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('<select id="checkTmpByParam" parameterMap="checkTmpMap" statementType="CALLABLE">\n    CALL P_BILL_LIST_IMPCHK(?,?,?,?,?,?,?,?,?)\n</select>\n')])])]),t("p",[e._v("存储过程参数")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v('<parameterMap type="java.util.Map" id="checkTmpMap">\n    <parameter property="P_MODIFY_MARK" mode="IN" jdbcType="VARCHAR"/>\n    <parameter property="P_RET_CODE" mode="INOUT" jdbcType="VARCHAR"/>\n</parameterMap>\n')])])]),t("p",[e._v("mysql 模糊查询")]),e._v(" "),t("p",[e._v("SELECT user_name, password, id\nFROM demo.test where user_name like char(10);")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v("<if test=\"inputDateFrom != null and inputDateFrom != ''\">\n        <![CDATA[ and INPUT_DATE >= to_date(#{inputDateFrom}, 'yyyy-mm-dd')]]>\n</if>\n<if test=\"inputDateTo != null and inputDateTo != ''\">\n    <![CDATA[ and INPUT_DATE < to_date(#{inputDateTo}, 'yyyy-mm-dd') + 1 ]]>\n</if>\n")])])]),t("p",[e._v("instr函数也有三种情况：")]),e._v(" "),t("p",[e._v("instr(字段,'关键字')>0相当于 字段like '%关键字%'")]),e._v(" "),t("p",[e._v("instr(字段,'关键字')=1相当于 字段like '关键字%'")]),e._v(" "),t("p",[e._v("instr(字段,'关键字')=0相当于 字段not like '%关键字%'")]),e._v(" "),t("p",[e._v("/* 校验是否包含特殊字符：\\t   \\n   \\r */")]),e._v(" "),t("p",[e._v("UPDATE we AS tmp\nSET temp_flag = '1', temp_remark = concat_ws('', tmp.temp_remark,'|规格型号中含有非法字符，如：\\n ')\nWHERE tmp.temp_owner =p_temp_owner\nand (position('\\n' in g_model ) > 0 or position(chr(10) in g_model ) > 0)\nAND EXISTS (SELECT\n1\nFROM ew\nwhere type='MODEL_ERR_CHAR' and code ='\\n' limit 1);")]),e._v(" "),t("p",[e._v("UPDATE ew AS tmp\nSET temp_flag = '1', temp_remark = concat_ws('', tmp.temp_remark,'|规格型号中含有非法字符，如：\\t ')\nWHERE tmp.temp_owner =p_temp_owner\nand (position('\\t' in g_model ) > 0 or position(chr(9) in g_model ) > 0)\nAND EXISTS (SELECT\n1\nFROM wew\nwhere type='MODEL_ERR_CHAR' and code ='\\t' limit 1);")]),e._v(" "),t("p",[e._v("UPDATE ewrwe AS tmp\nSET temp_flag = '1', temp_remark = concat_ws('', tmp.temp_remark,'|规格型号中含有非法字符，如：\\r ')\nWHERE tmp.temp_owner =p_temp_owner\nand (position('\\r' in g_model ) > 0 or position(chr(13) in g_model ) > 0)\nAND EXISTS (SELECT\n1\nFROM wewe\nwhere type='MODEL_ERR_CHAR' and code ='\\r' limit 1);")]),e._v(" "),t("p",[e._v("oracle,pgsql")]),e._v(" "),t("p",[e._v("INSERT INTO wewe (type,code,name,note,sid,head_id) VALUES\n('MODEL_ERR_CHAR', chr(9) chr(10) chr(13), '特殊字符', '清单规格型号错误字符',sys_guid(), (select sid from t_dc_bill_code_catalog where type = 'MODEL_ERR_CHAR' LIMIT 1));")]),e._v(" "),t("p",[e._v("mysql，sqlserver")]),e._v(" "),t("p",[e._v("INSERT INTO we (type,code,name,note,sid,head_id) VALUES\n('MODEL_ERR_CHAR', char(9) char(10) char(13), '特殊字符', '清单规格型号错误字符',sys_guid(), (select sid from t_dc_bill_code_catalog where type = 'MODEL_ERR_CHAR' LIMIT 1));")]),e._v(" "),t("p",[e._v("补位")]),e._v(" "),t("p",[e._v("lpad(password,2,'00')")]),e._v(" "),t("p",[e._v("截取")]),e._v(" "),t("p",[e._v("SID||'.'||reverse(split_part(reverse(origin_file_name), '.', 1)) as \"FileName\"")]),e._v(" "),t("p",[e._v("SID||'.'||SUBSTR(origin_file_name,\nINSTR(origin_file_name, '.', -1) + 1,\nLENGTH(origin_file_name)) as \"FileName\"")]),e._v(" "),t("p",[e._v("执行代码块")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[e._v(' <sql id="deleteTrDataTaskid_body">\n    delete from ewrw t where t.TASK_ID = #{taskId};\n\tdelete from werw t where t.TASK_ID = #{taskId};\n\tdelete from werw t where t.TASK_ID = #{taskId};\n</sql>\n\n<delete id="deleteEmsData" parameterType="String">\n    begin\n    <include refid="deleteEmsData_body"></include>\n    end;\n</delete>\n\n<delete id="deleteEmsData" parameterType="String" databaseId="postgresql">\n    <include refid="deleteEmsData_body"></include>\n</delete>\n')])])]),t("p",[e._v("update werw t\nset (dec_cm, dec_dm_invisiable, dec_dm_visiable,\nbond_mtpck_prpr, note, update_user) =\n(select p.dec_cm, p.dec_dm_invisiable, p.dec_dm_visiable,\np.bond_mtpck_prpr, p.note, p.update_user\nfrom werw p\nwhere t.cav_mark = p.cav_mark\nand t.cop_exg_no = p.cop_exg_no\nand t.cop_img_no = p.cop_img_no\nand t.exg_version = p.exg_version\nand p.cav_mark ='E2325B0A0008_01_01'\nand p.batch_no ='78d4f22f-e7ee-4880-81fa-4d973457e92a'\nand p.temp_flag != 1\n)\nwhere exists (\nselect 1 from werw p\nwhere t.cav_mark = p.cav_mark\nand t.cop_exg_no = p.cop_exg_no\nand t.cop_img_no = p.cop_img_no\nand t.exg_version = p.exg_version\nand p.cav_mark ='E2325B0A0008_01_01'\nand p.batch_no ='78d4f22f-e7ee-4880-81fa-4d973457e92a'\nand p.temp_flag != 1\n)\nand t.cav_mark = 'E2325B0A0008_01_01'")]),e._v(" "),t("p",[e._v("UPDATE werw t1\nSET DIFF_AMT =ROUND((F_XDO_NVL(t1.THE_RES_QTY,0.0)-F_XDO_NVL(t1.ACTUAL_STOCK_QTY,0.0))*(\nSELECT F_XDO_NVL(t2.AVG_PRICE,0.0)\nFROM werw t2\nWHERE t2.TRADE_CODE='3223942061'\nAND t2.CAV_MARK='E232519A0027_10_01'\nAND t2.ARC_MARK='E232519A0027_10_01'\nAND t2.COP_G_NO = t1.COP_G_NO\nAND t2.CAV_MARK=t1.CAV_MARK\n),5)\nWHERE t1.EMS_NO ='E232519A0027'\nAND t1.CAV_MARK = 'E232519A0027_10_01'\nAND exists (\nSELECT 1\nFROM werw t3\nWHERE t3.TRADE_CODE='3223942061'\nAND t3.CAV_MARK='E232519A0027_10_01'\nAND t3.ARC_MARK='E232519A0027_10_01'\nAND t3.COP_G_NO = t1.COP_G_NO\nAND t3.CAV_MARK=t1.CAV_MARK\n)")]),e._v(" "),t("p",[e._v("UPDATE\nwer O\nSET LOCK_MARK = #{batchId}\nWHERE EXISTS(\nSELECT 1\nFROM (\nSELECT SID,\nROW_NUMBER() OVER (\nORDER BY INSERT_TIME) RNUM\nFROM T_DC_BILL_CORE_TASK\nWHERE BUSINESS_TYPE = #{businessType}\nAND STATUS = #{lockStatus}\nAND LOCK_MARK IS NULL) T\nWHERE T.RNUM <= #{batchLockMaxCount}\nAND T.SID = O.SID)")])],1)}),[],!1,null,null,null);_.default=a.exports}}]);