(window.webpackJsonp=window.webpackJsonp||[]).push([[376],{866:function(n,t,e){"use strict";e.r(t);var r=e(6),i=Object(r.a)({},(function(){var n=this.$createElement,t=this._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":this.$parent.slotKey}},[t("h2",{attrs:{id:"spring-boot-admin开启认证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot-admin开启认证"}},[this._v("#")]),this._v(" Spring Boot Admin开启认证")]),this._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('监控类的数据 Web 管理端最好不要设置成直接通过输入访问地址就可以访问，必须得进行用户认证才行，以保证数据的安全性。Spring Boot Admin 开启认证也可以借助于 spring-boot-starter-security。\n\n加入依赖，代码如下所示。\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-security</artifactId>\n</dependency>\n\n然后在属性文件里面配置认证信息：\nspring.security.user.name=zhangsan\nspring.security.user.password=123456\n\n自定义安全配置类，代码如下所示。\n@Configuration\npublic static class SecurityPermitAllConfig extends WebSecurityConfigurerAdapter {\n    private final String adminContextPath;\n    public SecurityPermitAllConfig(AdminServerProperties adminServerProperties) {\n        this.adminContextPath = adminServerProperties.getContextPath();\n    }\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        SavedRequestAwareAuthenticationSuccessHandler successHandler = new SavedRequestAwareAuthenticationSuccessHandler();\n        successHandler.setTargetUrlParameter("redirectTo");\n        // 静态资源和登录页面可以不用认证\n        http.authorizeRequests().antMatchers(adminContextPath + "/assets/**").permitAll()\n                .antMatchers(adminContextPath + "/login").permitAll()\n                // 其他请求必须认证\n                .anyRequest().authenticated()\n                // 自定义登录和退出\n                .and().formLogin().loginPage(adminContextPath + "/login").successHandler(successHandler).and().logout()\n                .logoutUrl(adminContextPath + "/logout")\n                // 启用HTTP-Basic, 用于Spring Boot Admin Client注册\n                .and().httpBasic().and().csrf().disable();\n    }\n}\n重启程序，然后就会发现需要输入用户名和密码才能访问 Spring Boot Admin 的 Web 管理端，如下图所示。\n\n\n\n这里需要注意的是，如果 Spring Boot Admin 服务开启了认证，监控的服务中也需要配置对应的用户名和密码，否则会注册失败。\n\n在 spring-boot-admin-client 属性文件中加上用户认证信息：\nspring.boot.admin.client.username=zhangsan\nspring.boot.admin.client.password=123456\n\n账号密码需要跟 Spring Boot Admin Server 一致。\n\n')])])]),t("p",[t("img",{attrs:{src:"http://c.biancheng.net/uploads/allimg/190829/5-1ZR9163354312.png",alt:"RUNOOB 图标"}})])])}),[],!1,null,null,null);t.default=i.exports}}]);